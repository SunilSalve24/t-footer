<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-footer-panel/paper-header-panel.html">
<link rel="import" href="../paper-toolbar/paper-toolbar.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-tabs/paper-tabs.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-media-query/iron-media-query.html">
<link rel="import" href="../paper-tabs/paper-tab.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../iron-pages/iron-pages.html">
<link rel="import" href="../paper-menu/paper-menu.html">
<link rel="import" href="../paper-item/paper-icon-item.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../iron-icons/maps-icons.html">
<link rel="import" href="../iron-icons/communication-icons.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="./t-footer-style.html">

<!--
  `t-footer`
  Footer component

  @demo demo/index.html
-->

<dom-module id="t-footer">
  <template>
    <style is="custom-style" include="t-footer-style iron-flex iron-flex-alignment"></style>
    <iron-media-query query="(max-width: 1024px) and (min-width: 600px)" query-matches="{{_isTablet}}"></iron-media-query>
    <iron-media-query query="(min-width : 320px) and (max-width : 640px)" query-matches="{{_isMobile}}"></iron-media-query>
    <div class="layout footer">
      <paper-tabs hidden$="[[_hideIfNoSections(sections.options)]]" scrollable noink no-bar selected-class="selected-tab" class=" flex tabs" selected="{{_selected}}">
        <template is="dom-repeat" items="[[sections.options]]">
          <paper-tab>[[item.title]]</paper-tab>
        </template>
      </paper-tabs>

      <iron-pages hidden$="[[_hideIfNoSections(sections.options)]]" class="pages flex vertical layout " selected="{{_selected}}">
        <template is="dom-repeat" items="[[sections.options]]">
          <div>
            <ul class="items">
						<!-- <template is="dom&#45;if" if="[[!sections.openInNewTab]]" > -->
            <!--   <template is="dom&#45;repeat" items="[[item.options]]" as="option"> -->
            <!--     <li><a href$="[[option.url]]">[[option.title]]</a></li> -->
            <!--   </template> -->
            <!--   </template> -->
						<template is="dom-if" if="[[sections.openInNewTab]]" >
              <template is="dom-repeat" items="[[item.options]]" as="option">
                <li><a target="_blank" href$="[[option.url]]">[[option.title]]</a></li>
              </template>
              </template>
            </ul>
          </div>
        </template>
      </iron-pages>
			<div hidden$="[[_hideIfPrimaryAndSecondaryLinksNotPresent(links)]]"  class$="[[_centerAlignIfResponsive(_notDesktop)]] layout contact-section section">
				<div hidden$="[[_hideIfSectionNotPresent(links.primaryLinks.options)]]" class$="{{_centerAlignIfResponsive(_notDesktop)}} flex layout contact-us" >
					<div class="contact-label">[[links.primaryLinks.title]]</div>
					<div class$="{{_centerAlignIfResponsive(_notDesktop)}} layout details" >
						<template is="dom-repeat" items="[[links.primaryLinks.options]]" >
							<div >[[item.title]]
								<template is="dom-repeat" items="[[item.options]]" as="option" >
									<a href$="[[option.url]]">[[option.title]]</a>
								</template>
							</div>
						</template>
					</div>
				</div>
				<div hidden$="[[_hideSectionIfOverflowOrSectionNotPresent(links.secondaryLinks.options, _isMobile)]]" class$="[[_handleFollowAlignment(_isMobile) ]] wrap layout follow-us"  >
					<div class="contact-label">[[links.secondaryLinks.title]]</div>
					<div id="social" class="social-links">
						<template is="dom-repeat" items="[[links.secondaryLinks.options]]">
							<a href$="[[item.url]]"><iron-icon src="[[item.icon]]"></iron-icon></a>
						</template>
					</div>
				</div>
			</div>
			<div class$="[[ _centerAlignIfResponsive(_notDesktop) ]] contact-section layout follow-us" hidden$="[[!_hideIfContentOverflowHappens(links.secondaryLinks.options, _isMobile)]]" >
				<div class="contact-label">[[links.secondaryLinks.title]]</div>
				<div class="social-links">
					<template is="dom-repeat" items="[[links.secondaryLinks.options]]">
						<a href$="[[item.url]]"><iron-icon src="[[item.icon]]"></iron-icon></a>
					</template>
				</div>
			</div>
			<div hidden$="[[_hideIfNoChildren]]" class="layout horizontal copyright-section section">
				<content></content>
			</div>
			<div class="layout horizontal copyright-section section">
				<div class$="{{_centerAlignIfResponsive(_notDesktop)}} flex layout links" >
					<ul class="flex link-list">
						<template is="dom-repeat" items="[[links.bottomStartLinks]]">
							<li><a href$="[[item.url]]">[[item.title]]</a></li>
						</template>
					</ul>
				</div>

				<div hidden$="[[_notDesktop]]"  class="copyright end-justified">
					<template is="dom-repeat" items="[[links.bottomEndLinks]]">
				<a href$="[[item.url]]">[[item.title]]</a>
					</template>
				</div>
			</div>
			<div hidden$="[[!_notDesktop]]"  class="copyright-section section horizontal layout center-justified">
					<template is="dom-repeat" items="[[links.bottomEndLinks]]">
						<a href$="[[item.url]]">[[item.title]]</a>
					</template>
			</div>
		</div>



	</template>

	<script>
Polymer({
	is: 't-footer',

	observers:[
		'_arrangeSecondaryLinks(links.secondaryLinks.options.splices, _isMobile)'
	],

	properties: {
		_isMobile:{
			type: Boolean
		},
		_isTablet:{
			type: Boolean
		},
		sections:{
			type: Object
		},
		contactSection:{
			type: Object,
			notify: true
		},
		links:{
			type: Object,
			notify: true,
			required: true
		},
		copyright: {
			type: String
		},
		footerLinks:{
			type: Array
		},
		_arrangeSecondaryLinks: {
			type: String,
			computed: '_hideIfContentOverflowHappens(links.secondaryLinks.options.splices,_isMobile)'
		},
		_selected:{
			type: Number,
			value: 0
		},
		_notDesktop: {
			type: Boolean,
			// when `first` or `last` changes `computeFullName` is called once
			// and the value it returns is stored as `fullName`
			computed: '_isSmallScreen(_isTablet, _isMobile)'
		},
		_hideIfNoChildren:{
			type: Boolean,
			value: true
		},
		numberOfColumns:{
			type: Number,
			value: 6,
			notify: true
		}

	},

	ready: function(){
		this._hideIfNoChildren = Polymer.dom(this).children.length === 0;
	},

	_isSmallScreen: function(_isTablet, _isMobile){
		return _isTablet || _isMobile;
	},

	_centerAlignIfResponsive: function(_notDesktop){
		const primaryLinks = this._hideIfSectionNotPresent(this.links.primaryLinks.options);
		const secondaryLinks = this._hideIfSectionNotPresent(this.links.secondaryLinks.options);
		if(this._isMobile)
			return "vertical ";
		if(primaryLinks !== secondaryLinks)
			return "horizontal center-justified";
		if(this._hideIfContentOverflowHappens(this.links.secondaryLinks.options)){
			return "horizontal center-justified";
		}
		return "horizontal";
	},

	_handleFollowAlignment: function(_isMobile){
		return _isMobile? "center-justified vertical": "end-justified horizontal";
	},

	_hideIfNoSections: function(sections){
		return (!sections || sections.length === 0);
	},

	_hideIfContentOverflowHappens: function(options,_isMobile){
		return ((options && options.length> 5) || this._isTablet || this._isMobile);
	},

	_hideSectionIfOverflowOrSectionNotPresent: function(options, isMobile){
		return (this._hideIfNoSections(options) || this._hideIfContentOverflowHappens(options, isMobile));
	},

	_hideIfSectionNotPresent: function(items){
		return !(items && items.length > 0);
	},

	_hideIfPrimaryAndSecondaryLinksNotPresent: function(links){
		if(!this.links || (this._hideIfSectionNotPresent(links.primaryLinks.options) && this._hideIfSectionNotPresent(links.secondaryLinks.options)))
			return true;
		else
			return false;
	}

});
	</script>
</dom-module>
